
>ã“ã†ã„ã†ã€onChangeã‚’å¼•æ•°ã«æŒã¤ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã€useEffectã‚’ä½¿ã£ã¦ç™ºç«ã•ã›ã‚‹ã¨ç„¡é™ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«ãªã‚‹å•é¡Œãƒ»ãƒ»ãƒ» onChangeã‚’depsã‹ã‚‰å¤–ã›ã°ã„ã„ã‚“ã ã‘ã©eslint-disableä½¿ã†ã“ã¨ã«ãªã‚‹ã—ã€ã„ã„æ‰‹æ³•ãŒã‚ã‚Šãã†ãªã®ã«èª¿ã¹æ–¹ãŒåˆ†ã‹ã‚‰ãªã„
https://twitter.com/_kinmi/status/1683496500918190081
![[Pasted image 20230725202436.png]]

>ã“ã®ã‚±ãƒ¼ã‚¹ã§ã™ã¨ã€ handleChangeName, handleChangeDescription ã®ä¸­ã§ onChange ã‚’åŒæ™‚ã«å‘¼ã‚“ã§ã‚„ã‚‹å½¢ã«ãªã‚‹ã‹ã¨æ€ã„ã¾ã™

ä»¥ä¸‹ãŒå‚è€ƒã«ãªã‚‹

https://react.dev/learn/you-might-not-need-an-effect#notifying-parent-components-about-state-changes


ä¾‹ãˆã°ã€å†…éƒ¨ã§trueã‹falseã®ã©ã¡ã‚‰ã‹ã«ãªã‚‹isOnçŠ¶æ…‹ã‚’æŒã¤ãƒˆã‚°ãƒ«ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ›¸ã„ã¦ã„ã‚‹ã¨ã—ã¾ã™ã€‚ãƒˆã‚°ãƒ«ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã«ã¯ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ï¼ˆã‚¯ãƒªãƒƒã‚¯ã‚„ãƒ‰ãƒ©ãƒƒã‚°ï¼‰ã€‚Toggleã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†…éƒ¨çŠ¶æ…‹ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«é€šçŸ¥ã—ãŸã„ã®ã§ã€onChangeã‚¤ãƒ™ãƒ³ãƒˆã‚’å…¬é–‹ã—ã€Effectã‹ã‚‰å‘¼ã³å‡ºã—ã¾ã™ï¼š

```tsx
function Toggle({ onChange }) {  
  const [isOn, setIsOn] = useState(false);  

  // ğŸ”´ Avoid: The onChange handler runs too late  
  useEffect(() => {  
    onChange(isOn);  
  }, [isOn, onChange])  

  function handleClick() {  
    setIsOn(!isOn);  
  }  

  function handleDragEnd(e) {  
    if (isCloserToRightEdge(e)) {  
      setIsOn(true);  
    } else {  
      setIsOn(false);  
    }  
  }  

// ...  
}
```

å…ˆã»ã©ã¨åŒæ§˜ã€ã“ã‚Œã¯ç†æƒ³çš„ã§ã¯ãªã„ã€‚ã¾ãšToggleãŒçŠ¶æ…‹ã‚’æ›´æ–°ã—ã€ReactãŒç”»é¢ã‚’æ›´æ–°ã™ã‚‹ã€‚æ¬¡ã«Reactã¯Effectã‚’å®Ÿè¡Œã—ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰æ¸¡ã•ã‚ŒãŸonChangeé–¢æ•°ã‚’å‘¼ã³å‡ºã™ã€‚ä»Šåº¦ã¯ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒè‡ªèº«ã®çŠ¶æ…‹ã‚’æ›´æ–°ã—ã€åˆ¥ã®ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‘ã‚¹ã‚’é–‹å§‹ã™ã‚‹ã€‚ã™ã¹ã¦ã‚’1å›ã®ãƒ‘ã‚¹ã§è¡Œã†æ–¹ãŒè‰¯ã„ã ã‚ã†ã€‚  
  
Effectã‚’å‰Šé™¤ã—ã€ä»£ã‚ã‚Šã«åŒã˜ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©å†…ã§ä¸¡æ–¹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çŠ¶æ…‹ã‚’æ›´æ–°ã—ã¾ã™ï¼š

```tsx
function Toggle({ onChange }) {
  const [isOn, setIsOn] = useState(false);

  function updateToggle(nextIsOn) {
    // âœ… Good: Perform all updates during the event that caused them
    setIsOn(nextIsOn);
    onChange(nextIsOn);
  }

  function handleClick() {
    updateToggle(!isOn);
  }

  function handleDragEnd(e) {
    if (isCloserToRightEdge(e)) {
      updateToggle(true);
    } else {
      updateToggle(false);
    }
  }

  // ...
}
```

ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã¯ã€ãƒˆã‚°ãƒ«ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãã®è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¸¡æ–¹ãŒã€ã‚¤ãƒ™ãƒ³ãƒˆä¸­ã«çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹ã€‚Reactã¯ã€ç•°ãªã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ›´æ–°ã‚’ä¸€æ‹¬ã—ã¦å‡¦ç†ã™ã‚‹ãŸã‚ã€ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‘ã‚¹ã¯1å›ã§æ¸ˆã¿ã¾ã™ã€‚  
  
çŠ¶æ…‹ã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¦ã€ä»£ã‚ã‚Šã«è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰isOnã‚’å—ã‘å–ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š

```tsx
// âœ… Also good: the component is fully controlled by its parent
function Toggle({ isOn, onChange }) {
  function handleClick() {
    onChange(!isOn);
  }

  function handleDragEnd(e) {
    if (isCloserToRightEdge(e)) {
      onChange(true);
    } else {
      onChange(false);
    }
  }

  // ...
}
```

#react