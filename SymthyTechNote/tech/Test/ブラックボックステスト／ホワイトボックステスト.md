
ブラックボックステストとホワイトボックステストの具体的な手法について説明します。

## ブラックボックステスト
ブラックボックステストは、システムの内部構造を考慮せずに、外部から見た動作をテストする手法です。入力と出力に基づいてシステムの機能を検証します。

### 具体的手法

1. **同値分割（Equivalence Partitioning）**
   - 入力データを同値クラスに分割し、それぞれのクラスから代表的な値を選んでテストします。これにより、テストケースの数を減らしつつ、代表的な入力の範囲をカバーします。
   - 例: ユーザーの年齢を入力するフィールドの場合、0-17歳（未成年）、18-64歳（成人）、65歳以上（高齢者）といった同値クラスに分けます。

2. **境界値分析（Boundary Value Analysis）**
   - 入力の境界値付近を重点的にテストします。これは、バグが境界値付近で発生しやすいという経験則に基づきます。
   - 例: 入力フィールドに許可される最大文字数が50文字の場合、49文字、50文字、51文字の入力をテストします。

3. **原因結果グラフ（Cause-Effect Graphing）**
   - 入力条件（原因）と出力結果（効果）をグラフで表し、各条件の組み合わせをテストします。複雑なロジックやビジネスルールのテストに有効です。
   - 例: 複数の入力条件が組み合わさることで特定の結果が得られる計算処理などに適用します。

4. **決定表テスト（Decision Table Testing）**
   - 入力条件とその組み合わせによる出力を表形式で整理し、全ての条件組み合わせをテストします。条件が多い場合に有効です。
   - 例: 複数の割引条件があるオンラインショッピングシステムで、各割引条件の組み合わせをテストします。

原因結果グラフをユニットテストで行う場合、以下のステップに従って具体的な手法を説明します。

### 原因結果グラフの作成とユニットテストへの適用

視覚的表現
- 原因（入力条件）と結果（出力条件）の関係を視覚的にグラフとして表現
- 因果関係を矢印で示し、どの原因がどの結果に影響するかを明確化
- 条件と結果の関係が複雑で、視覚的に因果関係を把握したい場合に有効

原因結果グラフをユニットテストで行う場合、以下の手順を踏むのが妥当です：
1. **原因と結果の特定**：テスト対象の機能に関連するすべての入力(条件)と出力(条件)を特定します。
2. **原因結果グラフの作成**：原因と結果の関係をグラフで表現します。
3. **テストケースの生成**：原因結果グラフを基にテストケースを作成します。
4. **テストコードの実装**：生成したテストケースをコードに変換します。

これにより、複雑な機能のすべての重要な組み合わせをカバーするテストケースを網羅的に作成できます。

#### 1. 原因と結果の特定
最初に、システムの特定の機能に関連するすべての入力（原因）と出力（結果）を特定します。

例: ログイン機能に関する原因と結果
- 原因(入力):
  - ユーザー名が正しい
  - ユーザー名が間違っている
  - パスワードが正しい
  - パスワードが間違っている
- 結果(出力):
  - ログイン成功
  - ログイン失敗

#### 2. 原因結果グラフの作成
原因と結果の関係をグラフで表現します。各原因が結果にどのように影響するかを示します。

```plaintext
(ユーザー名が正しい) ----> (ログイン成功)
                   |
                   +----> (ログイン失敗)
(ユーザー名が間違っている) --> (ログイン失敗)

(パスワードが正しい) ----> (ログイン成功)
                   |
                   +----> (ログイン失敗)
(パスワードが間違っている) --> (ログイン失敗)
```

#### 3. テストケースの生成
原因結果グラフをもとに、各パスに対応するテストケースを作成します。これにより、すべての重要な組み合わせをカバーするテストケースを網羅できます。

#### 4. テストコードの実装
生成したテストケースをコードに変換します。

#### 具体例

##### 原因結果グラフの入力データ
- ユーザー名が正しい (`validUsername`)
- ユーザー名が間違っている (`invalidUsername`)
- パスワードが正しい (`validPassword`)
- パスワードが間違っている (`invalidPassword`)

##### テストケースの生成
1. ユーザー名とパスワードが正しい場合: ログイン成功
2. ユーザー名が正しく、パスワードが間違っている場合: ログイン失敗
3. ユーザー名が間違っていて、パスワードが正しい場合: ログイン失敗
4. ユーザー名とパスワードが間違っている場合: ログイン失敗


### 決定表の例

例えば、オンラインショッピングシステムの割引適用に関する決定表を考えてみましょう。

- **条件**:
    
    1. 顧客がVIP会員か？
    2. 商品の在庫があるか？
    3. クーポンが有効か？
- **結果**:
    
    1. 割引が適用される
    2. 割引が適用されない

#### 決定表

|条件|ルール1|ルール2|ルール3|ルール4|ルール5|ルール6|ルール7|ルール8|
|---|---|---|---|---|---|---|---|---|
|顧客がVIP会員か？|Yes|Yes|Yes|Yes|No|No|No|No|
|商品の在庫があるか？|Yes|Yes|No|No|Yes|Yes|No|No|
|クーポンが有効か？|Yes|No|Yes|No|Yes|No|Yes|No|
|割引が適用される|Yes|Yes|No|No|Yes|No|No|No|

## ホワイトボックステスト
ホワイトボックステストは、システムの内部構造や実装を考慮してテストを行う手法です。コードの内部ロジック、分岐、ループなどをテストします。

#### 具体的手法

1. **ステートメントカバレッジ（Statement Coverage）**
   - すべてのコード行（ステートメント）が少なくとも一度は実行されることを確認します。
   - 例: 各コード行が実行されるように、入力条件を設定してテストケースを作成します。

2. **ブランチカバレッジ（Branch Coverage）**
   - すべての分岐（if文やcase文）の真偽両方のパスを少なくとも一度は通ることを確認します。
   - 例: if文の条件がtrueの場合とfalseの場合の両方をテストします。

3. **パスカバレッジ（Path Coverage）**
   - すべての可能な経路（パス）をテストします。これは最も包括的なカバレッジで、非常に多くのテストケースが必要です。
   - 例: コードの全ての条件分岐やループのすべての経路を通るようにテストケースを作成します。

4. **データフロー分析（Data Flow Testing）**
   - 変数の定義（定義される場所）、使用（使われる場所）、および消去（使用されなくなる場所）をテストします。変数のライフサイクルに着目してテストを行います。
   - 例: 変数が正しく初期化され、適切に使用され、不要になった時点で正しく破棄されることを確認します。

5. **ループテスト（Loop Testing）**
   - ループ構造の開始、実行回数、終了をテストします。ループの境界条件を重点的にテストします。
   - 例: ループが0回、1回、最大回数、最大回数＋1回などで正しく動作するかをテストします。

### まとめ
- **ブラックボックステスト**は、システムの外部から見た動作を検証し、同値分割、境界値分析、原因結果グラフ、決定表テストなどの手法を用います。
- **ホワイトボックステスト**は、システムの内部構造を検証し、ステートメントカバレッジ、ブランチカバレッジ、パスカバレッジ、データフロー分析、ループテストなどの手法を用います。

これらのテスト手法を組み合わせることで、より包括的で効果的なテストを行うことができます。